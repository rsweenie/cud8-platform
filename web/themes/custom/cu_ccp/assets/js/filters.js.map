{"version":3,"names":[],"mappings":"","sources":["filters.js"],"sourcesContent":["'use strict';\n\n(function ($, Drupal) {\n  Drupal.behaviors.programsFilters = {\n    attach: function (context, settings) {\n      $('.view', context).once('programsFilters').each(function() {\n        var $view = $(this),\n            $programs = $('.programs', $view),\n            $filters = $('.program-filters', $view);\n\n        $programs.find('button').each(function(i, el) {\n          var triggers = $programs.find('button');\n          var panels = $filters.children('div');\n\n          $(el).on('click', function(e) {\n            var btn = $(e.currentTarget), \n                ref = btn.attr('aria-controls'),\n                trgt = $filters.find('div#'+ref),\n                activBtn = btn.parent().find('button[aria-expanded=\"true\"]'),\n                activPanel;\n\n            $(panels).each(function(n, panel_el) {\n              if (!$(panel_el).is( \":hidden\" )) {\n                activPanel = $(panel_el);\n              }\n            });\n\n            if (btn.attr('aria-expanded') === \"true\") {\n              btn.attr('aria-expanded', \"false\");\n              trgt.attr('hidden', 'true');\n            }\n            else {\n              activBtn.attr('aria-expanded', \"false\");\n              if (activPanel !== undefined) {\n                activPanel.attr('hidden', 'true');\n              }\n              btn.attr('aria-expanded', \"true\");\n              trgt.removeAttr('hidden');\n            }\n          });\n        });\n      });\n    }\n  };\n\n  Drupal.behaviors.programsViewSummary = {\n    attach: function (context, settings) {\n      $('.view', context).once('programsViewSummary').each(function() {\n        var $view = $(this),\n            $filters = $('.program-filters', $view);\n\n        if ($filters.length > 0) {\n          $('.view-summary', $view).appendTo($('.view-filters form', $view));\n        }\n      });\n    }\n  };\n\n  Drupal.behaviors.programsFilterFacets = {\n    attach: function (context, settings) {\n      $('.view', context).once('programsFilterFacets').each(function() {\n        var $view = $(this),\n            $programs = $('.programs', $view),\n            $filters = $('.program-filters', $view),\n            $panels = $filters.children('div'),\n            $sorts = $('.sort', $view);\n\n        // Make a new container element for the facets.\n        var $facets = $('<div></div>').addClass('program-facets');\n\n        $panels.each(function(n, panel_el) {\n          var $selected = $('input[value!=\"All\"]:checked', panel_el).closest('.form-item');\n          $selected.each(function (n, selected_el) {\n            var $selected_el = $(selected_el);\n            var label = $('label', selected_el)\n              .clone()\n              .find('.tooltip')\n                .remove()\n                .end()\n              .text();\n            \n            var $facet = $('<div></div>')\n              .addClass('facet')\n              .text(label)\n              .appendTo($facets);\n\n            $facet.on('click', function(e) {\n              console.log($selected_el);\n              $selected_el\n                .find('input')\n                  .removeAttr('checked')\n                  .end()\n                .closest('form')\n                  .submit();\n            });\n          });\n        });\n\n        $facets.appendTo($sorts.closest('form'));\n      });\n    }\n  };\n  \n})(jQuery, Drupal);\n"],"file":"filters.js"}